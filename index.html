<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vox AI Studio - Professional Camb AI Edition</title>
    <style>
        :root { --bg: #050505; --card: #0f0f0f; --accent: #ffffff; --premium: #d4af37; }
        body { background-color: var(--bg); color: white; font-family: 'Inter', sans-serif; margin: 0; padding: 20px; }

        header { display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; border-bottom: 1px solid #222; }
        .logo-box { display: flex; align-items: center; gap: 10px; }
        .logo-icon { width: 32px; height: 32px; background: white; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .logo-text { font-size: 20px; font-weight: 900; }

        .nav-tabs { display: flex; justify-content: center; gap: 10px; margin: 20px 0; }
        .tab-btn { background: #1a1a1a; color: #888; border: none; padding: 12px 20px; border-radius: 12px; cursor: pointer; transition: 0.3s; }
        .tab-btn.active { background: #333; color: white; font-weight: bold; }

        .editor-container { max-width: 600px; margin: 0 auto; background: var(--card); border-radius: 28px; padding: 30px; border: 1px solid #222; }
        
        select { width: 100%; background: #1a1a1a; color: white; border: 1px solid #333; padding: 16px; border-radius: 12px; outline: none; font-size: 16px; margin-bottom: 15px; cursor: pointer; }
        optgroup { color: var(--premium); font-weight: bold; background: #000; }
        option { color: white; background: #1a1a1a; }

        textarea { width: 100%; height: 200px; background: #1a1a1a; color: white; border: 1px solid #333; padding: 14px; border-radius: 12px; outline: none; font-size: 16px; resize: none; box-sizing: border-box; }

        .btn-main { width: 100%; padding: 18px; background: white; color: black; border-radius: 50px; border: none; font-weight: bold; font-size: 18px; cursor: pointer; margin-top: 15px; transition: 0.3s; }
        .btn-main:disabled { background: #333; color: #777; cursor: not-allowed; }

        .upload-area { border: 2px dashed #333; padding: 50px 20px; text-align: center; border-radius: 20px; margin-top: 15px; cursor: pointer; background: #111; }
        .upload-area:hover { border-color: var(--premium); }
        .hidden { display: none; }
    </style>
</head>
<body>

    <header>
        <div class="logo-box">
            <div class="logo-icon"><svg viewBox="0 0 24 24" width="20"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z"/></svg></div>
            <div class="logo-text">Vox AI Studio</div>
        </div>
    </header>

    <div class="nav-tabs">
        <button class="tab-btn active" onclick="switchTab('tts')">Text to Speech</button>
        <button class="tab-btn" onclick="switchTab('dubbing')">AI Dubbing & Changer</button>
    </div>

    <div id="tts-section" class="editor-container">
        
        <select id="voice-select">
            <optgroup label="Historical & Heavy Voices">
                <option value="147320">1. Marcus (Deep Male - History & Epics)</option>
                <option value="147321">2. Frank (Studio Male - Heavy Impact)</option>
                <option value="147322">3. Vikram (Authoritative Indian Male)</option>
                <option value="147323">4. Sarah (Grave Female Narrator)</option>
                <option value="147324">5. Meera (Classic Indian Female)</option>
            </optgroup>
            <optgroup label="Storytelling (Long Episodes)">
                <option value="147325">6. Pankaj (Warm Male Storyteller)</option>
                <option value="147326">7. Jina (Soft Female Voice)</option>
                <option value="147327">8. Heroic Male (Action / Drama)</option>
                <option value="147328">9. Bella (Emotional Female)</option>
                <option value="147329">10. Kabir (Young Male Character)</option>
                <option value="147330">11. Ananya (Expressive Female)</option>
                <option value="147331">12. Rohan (Casual Male Voice)</option>
            </optgroup>
            <optgroup label="Health, Fitness & Education">
                <option value="147332">13. Energetic Male (Fitness Motivation)</option>
                <option value="147333">14. Calm Female (Home Remedies)</option>
                <option value="147334">15. Rahul (Friendly Coach)</option>
                <option value="147335">16. Priya (Clear Instructor)</option>
            </optgroup>
            <optgroup label="General & News Style">
                <option value="147336">17. Amit (News Style Male)</option>
                <option value="147337">18. Neha (Upbeat Female)</option>
                <option value="147338">19. Arjun (Deep Bass Male)</option>
                <option value="147339">20. Sneha (Professional Female)</option>
            </optgroup>
        </select>

        <textarea id="text-input" placeholder="Apni script yahan paste karein..."></textarea>
        <button class="btn-main" onclick="generateVoice()">Generate AI Voice</button>
    </div>

    <div id="dubbing-section" class="editor-container hidden">
        
        <select id="target-language">
            <option value="1">Dub in: English</option>
            <option value="2" selected>Dub in: Hindi</option>
            <option value="3">Dub in: Marathi</option>
            <option value="4">Dub in: Gujarati</option>
            <option value="5">Dub in: Tamil</option>
            <option value="6">Dub in: Telugu</option>
            <option value="7">Dub in: Bengali</option>
        </select>

        <label for="file-upload">
            <div class="upload-area" id="drop-zone">
                <p id="upload-text">üìÅ Click here to upload Video/Audio<br><small>(Max 50MB)</small></p>
            </div>
        </label>
        <input type="file" id="file-upload" class="hidden" accept="video/*,audio/*" onchange="handleFileUpload(this)">
        
        <button class="btn-main" id="change-voice-btn" disabled onclick="startDubbing()">Start Voice Dubbing</button>
    </div>

    <script>
        // Tab Switch Logic
        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('tts-section').classList.add('hidden');
            document.getElementById('dubbing-section').classList.add('hidden');
            
            document.getElementById(tab + '-section').classList.remove('hidden');
        }

        // File Upload Logic
        function handleFileUpload(input) {
            const file = input.files[0];
            const status = document.getElementById('upload-text');
            const btn = document.getElementById('change-voice-btn');
            
            if (file) {
                if (file.size > 50 * 1024 * 1024) {
                    alert("‚ö†Ô∏è 50MB se badi file allowed nahi hai!");
                    input.value = "";
                    status.innerHTML = "‚ùå File Too Large (Max 50MB)";
                    btn.disabled = true;
                } else {
                    status.innerHTML = "‚úÖ Ready: " + file.name;
                    btn.disabled = false;
                }
            }
        }

        // CAMB AI - Text to Speech Generation
        async function generateVoice() {
            const text = document.getElementById('text-input').value;
            const voiceId = document.getElementById('voice-select').value;
            const btn = document.querySelector('#tts-section .btn-main');

            if (!text.trim()) return alert("Pehle apni script likhein!");

            btn.innerText = "Connecting to Camb AI...";
            btn.disabled = true;

            try {
                const response = await fetch('/.netlify/functions/tts', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ text: text, voice_id: parseInt(voiceId) })
                });

                const data = await response.json();

                if (response.ok && data.audio) {
                    const audio = new Audio(`data:audio/mp3;base64,${data.audio}`);
                    audio.play();
                    btn.innerText = "‚úÖ AI Voice Playing!";
                } else {
                    throw new Error(data.error || "Awaaz generate nahi hui. Backend check karein.");
                }
            } catch (e) {
                alert("Server Connection Failed: " + e.message);
            } finally {
                setTimeout(() => { 
                    btn.disabled = false; 
                    btn.innerText = "Generate AI Voice"; 
                }, 4000);
            }
        }

        // CAMB AI - Dubbing/Voice Changer Processing
        async function startDubbing() {
            const fileInput = document.getElementById('file-upload');
            const targetLang = document.getElementById('target-language').value;
            const btn = document.getElementById('change-voice-btn');
            const statusText = document.getElementById('upload-text');

            if (!fileInput.files.length) return alert("Pehle koi Video ya Audio upload karein!");

            btn.innerText = "‚è≥ Uploading to Server...";
            btn.disabled = true;

            try {
                const file = fileInput.files[0];
                const reader = new FileReader();
                reader.readAsDataURL(file);
                
                reader.onload = async () => {
                    const base64Data = reader.result.split(',')[1];

                    const response = await fetch('/.netlify/functions/changer', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            fileName: file.name,
                            fileData: base64Data,
                            targetLang: parseInt(targetLang)
                        })
                    });

                    const data = await response.json();

                    if (response.ok) {
                        statusText.innerHTML = "‚úÖ Dubbing Successful!";
                        btn.innerText = "Dubbing Complete";
                        alert("File processed successfully!");
                    } else {
                        throw new Error(data.error || "Dubbing failed.");
                    }
                    btn.disabled = false;
                };
            } catch (e) {
                alert("Error: " + e.message);
                statusText.innerHTML = "‚ùå Upload Failed";
                btn.innerText = "Start Voice Dubbing";
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
